{
  "fileSummary": {
    "generationHeader": "This file is a merged representation of the entire codebase, combined into a single document by Repomix.",
    "purpose": "This file contains a packed representation of the entire repository's contents.\nIt is designed to be easily consumable by AI systems for analysis, code review,\nor other automated processes.",
    "fileFormat": "The content is organized as follows:\n1. This summary section\n2. Repository information\n3. Directory structure\n4. Repository files, each consisting of:\n   - File path as a key\n   - Full contents of the file as the value",
    "usageGuidelines": "- This file should be treated as read-only. Any changes should be made to the\n  original repository files, not this packed version.\n- When processing this file, use the file path to distinguish\n  between different files in the repository.\n- Be aware that this file may contain sensitive information. Handle it with\n  the same level of security as you would the original repository.",
    "notes": "- Some files may have been excluded based on .gitignore rules and Repomix's configuration\n- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files\n- Files matching patterns in .gitignore are excluded\n- Files matching default ignore patterns are excluded\n- Files are sorted by Git change count (files with more changes are at the bottom)"
  },
  "directoryStructure": "models/\n  booking_seat.py\n  booking.py\n  movie.py\n  screen.py\n  seat.py\n  show.py\n  theatre.py\n  user.py\n.repomixignore\ncreate_tables.py\ncrud_test.py\ndatabase.py\ndb_test.py\ndocker-compose.yml\nrequirements.txt\ntransaction_test.py",
  "files": {
    "models/booking_seat.py": "from database import Base\nfrom sqlalchemy import Column, Integer, ForeignKey\n\nclass BookingSeat(Base):\n    __tablename__ = \"booking_seats\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    booking_id = Column(Integer, ForeignKey(\"bookings.id\"), nullable=False)\n    seat_id = Column(Integer, ForeignKey(\"seats.id\"), nullable=False)",
    "models/booking.py": "from database import Base\nfrom sqlalchemy import Column, Integer, ForeignKey, TIMESTAMP, Numeric, Text\nfrom sqlalchemy.sql import func\n\nclass Booking(Base):\n    __tablename__ = \"bookings\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    user_id = Column(Integer, ForeignKey(\"users.id\"), nullable=False)\n    show_id = Column(Integer, ForeignKey(\"shows.id\"), nullable=False)\n    total_price = Column(Numeric, nullable=False)\n    status = Column(Text, nullable=False)\n    created_at = Column(TIMESTAMP, server_default=func.now(), nullable=False)",
    "models/movie.py": "from database import Base\nfrom sqlalchemy import Column, Integer, Text, TIMESTAMP\nfrom sqlalchemy.sql import func\n\nclass Movie(Base):\n    __tablename__ = \"movies\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    title = Column(Text, nullable=False)\n    description = Column(Text)\n    duration_minutes = Column(Integer, nullable=False)\n    language = Column(Text, nullable=False)\n    genre = Column(Text, nullable=False)\n    release_date = Column(TIMESTAMP, nullable=False)\n    created_at = Column(TIMESTAMP, server_default=func.now(), nullable=False)",
    "models/screen.py": "from database import Base\nfrom sqlalchemy import Column, Integer, Text, ForeignKey\n\nclass Screen(Base):\n    __tablename__ = \"screens\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    theatre_id = Column(Integer, ForeignKey(\"theatres.id\"), nullable=False)\n    name = Column(Text, nullable=False)\n    total_seats = Column(Integer, nullable=False)",
    "models/seat.py": "from database import Base\nfrom sqlalchemy import Column, Integer, Text, ForeignKey\n\nclass Seat(Base):\n    __tablename__ = \"seats\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    screen_id = Column(Integer, ForeignKey(\"screens.id\"), nullable=False)\n    seat_number = Column(Integer, nullable=False)\n    row_label = Column(Text, nullable=False)\n    seat_type = Column(Text, nullable=False)",
    "models/show.py": "from database import Base\nfrom sqlalchemy import Column, Integer, ForeignKey, TIMESTAMP, Numeric\nfrom sqlalchemy.sql import func\n\nclass Show(Base):\n    __tablename__ = \"shows\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    movie_id = Column(Integer, ForeignKey(\"movies.id\"), nullable=False)\n    screen_id = Column(Integer, ForeignKey(\"screens.id\"), nullable=False)\n    start_time = Column(TIMESTAMP, nullable=False)\n    end_time = Column(TIMESTAMP, nullable=False)\n    price = Column(Numeric, nullable=False)\n    created_at = Column(TIMESTAMP, server_default=func.now(), nullable=False)",
    "models/theatre.py": "from database import Base\nfrom sqlalchemy import Column, Integer, Text, TIMESTAMP\nfrom sqlalchemy.sql import func\n\nclass Theatre(Base):\n    __tablename__ = \"theatres\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    name = Column(Text, nullable=False)\n    city = Column(Text, nullable=False)\n    address = Column(Text)\n    created_at = Column(TIMESTAMP, server_default=func.now(), nullable=False)",
    "models/user.py": "from database import Base\nfrom sqlalchemy import Column, Integer, Text, TIMESTAMP\nfrom sqlalchemy.sql import func\n\nclass User(Base):\n    __tablename__ = \"users\"\n\n    id = Column(Integer, primary_key=True, index=True)\n    email = Column(Text, unique=True, nullable=False, index=True)\n    password_hash = Column(Text, nullable=False)\n    name = Column(Text, nullable=False)\n    created_at = Column(TIMESTAMP, server_default=func.now(), nullable=False)\n    updated_at = Column(TIMESTAMP, server_default=func.now(), onupdate=func.now(), nullable=False)",
    ".repomixignore": "# Virtual environments\nvenv/\n.venv/\nenv/\nENV/\n\n# Python cache\n__pycache__/\n*.pyc\n*.pyo\n*.pyd\n\n# Distribution / packaging\nbuild/\ndist/\n*.egg-info/\n.eggs/\n\n# Logs\n*.log\n\n# IDE files\n.vscode/\n.idea/\n\n# OS files\n.DS_Store\nThumbs.db\n\n# Git\n.git/\n\n# Test cache\n.pytest_cache/\n.coverage\nhtmlcov/\n\n# Mypy / linters\n.mypy_cache/\n.ruff_cache/\n\n# Jupyter checkpoints\n.ipynb_checkpoints/\n\n# Large data\ndata/\ndatasets/\n*.csv\n*.parquet\n\n# Node (if mixed project)\nnode_modules/\n\n# Temporary files\ntmp/\ntemp/\n\n# Secrets\n.env\n.env.*",
    "create_tables.py": "from database import engine, Base\n\nfrom models.user import User\nfrom models.movie import Movie\nfrom models.theatre import Theatre\nfrom models.screen import Screen\nfrom models.seat import Seat\nfrom models.show import Show\nfrom models.booking import Booking\nfrom models.booking_seat import BookingSeat\n\nBase.metadata.create_all(bind=engine)",
    "crud_test.py": "from database import SessionLocal\nfrom models.user import User\n\ndb = SessionLocal()\n\nnew_user = User(\n    email=\"test@example.com\",\n    password_hash=\"hashedpassword123\",\n    name=\"Test User\"\n)\n\nexisting_user = db.query(User).filter(User.email == \"test@example.com\").first()\n\nif not existing_user:\n    db.add(new_user)\n    db.commit()\n    db.refresh(new_user)\n    print(\"New user id: \", new_user.id)\n\nelse:\n    print(\"User already exists with ID: \", existing_user.id)\n\nusers = db.query(User).all()\n\nfor user in users:\n    print(user.id, user.name, user.email)",
    "database.py": "from sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker , declarative_base\n\nDATABASE_URL = \"postgresql://admin:password@localhost:5432/bookmyshow_db\"\nengine = create_engine(DATABASE_URL)\n\nSessionLocal = sessionmaker(bind=engine)\nBase = declarative_base()",
    "db_test.py": "from sqlalchemy import text\nfrom database import engine\n\nwith engine.connect() as connection:\n    result = connection.execute(text(\"SELECT 1\"))\n    print(result.scalar())",
    "docker-compose.yml": "version: \"3.9\"\n\nservices:\n  postgres:\n    image: postgres:16\n    container_name: bookmyshow_postgres\n    restart: always\n\n    environment:\n      POSTGRES_USER: admin\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: bookmyshow_db\n\n    ports:\n      - \"5432:5432\"\n\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\nvolumes:\n  postgres_data:",
    "requirements.txt": "greenlet==3.3.1\npsycopg2-binary==2.9.11\npython-dotenv==1.2.1\nSQLAlchemy==2.0.46\ntyping_extensions==4.15.0",
    "transaction_test.py": "from database import SessionLocal\nfrom models.user import User\n\ndb = SessionLocal()\n\ntry:\n    user = User(\n        email=\"rollback@test.com\",\n        password_hash=\"hash123\",\n        name=\"Rollback User\"\n        )\n    \n    db.add(user)\n\n    raise Exception(\"Simulated failure before commit\")\n\nexcept Exception as e:\n    print(\"Error occured:\", e)\n    db.rollback()\n\nfinally:\n    db.close()"
  }
}